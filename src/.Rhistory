## UPDATE THE FILE PATHS TO REFLECT THE NAMES OF THE SURVEYS ON YOUR MACHINE##
originalsurvey22 = read_excel("~/Desktop/cc_tenant_satisfaction_survey/materials/cc_2022_tenSatSurvey.xlsx")
survey22 = read_excel("~/Desktop/cc_tenant_satisfaction_survey/materials/cc_2022_tenSatSurvey.xlsx")
survey21 = read_excel("~/Desktop/cc_tenant_satisfaction_survey/materials/cc_2021_tenSatSurvey.xlsx")
survey22 = clean_survey(survey22) # clean 2022 survey
survey21 = clean_survey(survey21) # clean 2021 survey
## LOAD QUESTION WEIGHT TABL ##
question_weights = read_excel("~/Desktop/question_weight.xlsx")
resp_test = resp_by_facility(survey22)
source("~/Desktop/TSS_folder/tenant_survey_functionsCopy.R")
resp_test = resp_by_facility(survey22)
resp_test = resp_by_facility(survey22)
detach("package:matrixStats", unload = TRUE)
source("~/Desktop/TSS_folder/tenant_survey_functionsCopy.R")
resp_test = resp_by_facility(survey22)
## Responses by year
resp_by_year(survey22)
source("~/Desktop/TSS_folder/tenant_survey_functionsCopy.R")
resp_test = resp_by_facility(survey22)
## Responses by year
resp_by_year(survey22)
satisfaction_table22 = satisfaction_table(survey22)
mean_sat_table22 = mean_question_satisfaction_by_facility(survey22)
View(mean_sat_table22)
View(satisfaction_table22)
write.xlsx(originalsurvey22,'~/Desktop/TSS_folder/TSS_Survey_Anlysis_Test.xlsx', sheetName="Og_Survey22")
write.xlsx(originalsurvey22,'~/Desktop/TSS_folder/TSS_Survey_Analysis_Test.xlsx', sheetName="Og_Survey22")
write.xlsx(survey22,'~/Desktop/TSS_folder/TSS_Survey_Analysis_Test.xlsx', sheetName="clean_survey22")
View(survey22)
View(originalsurvey22)
# Create a blank workbook
excel_survey <- createWorkbook()
# Add some sheets to the workbook
addWorksheet(excel_survey, "og_survey22")
addWorksheet(excel_survey, "clean_survey22")
# Write the data to the sheets
writeData(excel_survey, sheet = "og_survey22", x = originalsurvey22)
# Export the file
saveWorkbook(excel_survey, "TSS_Survey_Analysis_Test.xlsx")
write.xlsx(survey22,'~/Desktop/TSS_folder/TSS_Survey_Analysis_Test.xlsx', sheetName="clean_survey22", append = TRUE)
write.xlsx(originalsurvey22,'~/Desktop/TSS_folder/TSS_Survey_Analysis_Test.xlsx', sheetName="Og_Survey22", append = TRUE)
install.packages(xlsx)
library(xlsx)
install.packages(xlsx)
library(xlsx)
# Create a blank workbook
excel_survey = createWorkbook()
# Add some sheets to the workbook
addWorksheet(excel_survey, "og_survey22")
addWorksheet(excel_survey, "clean_survey22")
# Write the data to the sheets
writeData(excel_survey, sheet = "og_survey22", x = originalsurvey22)
writeData(excel_survey, sheet = "clean_survey22", x = survey22)
# Export the file
saveWorkbook(excel_survey, "TSS_Survey_Analysis_Test.xlsx")
write.xlsx(survey22,'~/Desktop/TSS_folder/TSS_Survey_Analysis_Test.xlsx', sheetName="clean_survey22", append = TRUE)
# Export the file
saveWorkbook(excel_survey, "TSS_Survey_Analysis_Test2.xlsx")
## Responses by year
num_responses = resp_by_year(survey22)
# Create a blank workbook
excel_survey = createWorkbook()
# Add some sheets to the workbook
addWorksheet(excel_survey, "og_survey22")
addWorksheet(excel_survey, "clean_survey22")
# Write the data to the sheets
writeData(excel_survey, sheet = "question_weights", x = originalsurvey22)
# Create a blank workbook
excel_survey = createWorkbook()
# Add some sheets to the workbook
addWorksheet(excel_survey, "question_weights")
addWorksheet(excel_survey, "clean_survey22")
addWorksheet(excel_survey, "num_responses22_21")
addWorksheet(excel_survey, "satisfaction_table22")
addWorksheet(excel_survey, "mean_satisfaction_by_facility22")
# Write the data to the sheets
writeData(excel_survey, sheet = "question_weights", x = question_weights)
writeData(excel_survey, sheet = "clean_survey22", x = survey22)
writeData(excel_survey, sheet = "num_responses22_21", x = num_responses)
writeData(excel_survey, sheet = "satisfaction_table22", x = satisfaction_table22)
writeData(excel_survey, sheet = "mean_satisfaction_by_facility22", x = mean_sat_table22)
# Export the file
saveWorkbook(excel_survey, "TSS_Survey_Analysis_Test.xlsx")
source("~/Desktop/TSS_folder/tenant_survey_functionsCopy.R")
View(question_weights)
mean_sat_table22 = mean_question_satisfaction_by_facility(survey22)
View(mean_sat_table22)
View(survey22)
install.packages(janitor)
library(janitor)
install.packages("janitor")
library(janitor)
source("~/Desktop/TSS_folder/tenant_survey_functionsCopy.R")
survey22 = clean_survey(survey22) # clean 2022 survey
View(survey22)
source("~/Desktop/TSS_folder/tenant_survey_functionsCopy.R")
source("~/Desktop/TSS_folder/tenant_survey_functionsCopy.R")
survey22 = clean_survey(survey22) # clean 2022 survey
View(survey22)
source("~/Desktop/TSS_folder/tenant_survey_functionsCopy.R")
survey22 = clean_survey(survey22) # clean 2022 survey
View(survey22)
source("~/Desktop/TSS_folder/tenant_survey_functionsCopy.R")
survey22 = clean_survey(survey22) # clean 2022 survey
source("~/Desktop/TSS_folder/tenant_survey_functionsCopy.R")
survey22 = read_excel("~/Desktop/cc_tenant_satisfaction_survey/materials/cc_2022_tenSatSurvey.xlsx")
survey22 = clean_survey(survey22) # clean 2022 survey
View(survey22)
source("~/Desktop/TSS_folder/tenant_survey_functionsCopy.R")
survey22 = clean_survey(survey22) # clean 2022 survey
survey22 = read_excel("~/Desktop/cc_tenant_satisfaction_survey/materials/cc_2022_tenSatSurvey.xlsx")
survey22 = clean_survey(survey22) # clean 2022 survey
View(survey22)
## Responses by year
num_responses = resp_by_year(survey22)
View(num_responses)
source("~/Desktop/TSS_folder/tenant_survey_functionsCopy.R")
## Responses by year
num_responses = resp_by_year(survey22)
View(num_responses)
# Create a blank workbook
excel_survey = createWorkbook()
# Add some sheets to the workbook
addWorksheet(excel_survey, "question_weights")
addWorksheet(excel_survey, "clean_survey22")
addWorksheet(excel_survey, "num_responses22_21")
addWorksheet(excel_survey, "satisfaction_table22")
addWorksheet(excel_survey, "mean_satisfaction_by_facility22")
# Write the data to the sheets
writeData(excel_survey, sheet = "question_weights", x = question_weights, tableStyle = "TablestyleMedium6")
# Write the data to the sheets
writeDataTable(excel_survey, sheet = "question_weights", x = question_weights, tableStyle = "TablestyleMedium6", headerStyle = bold_header)
bold_header = createStyle(border = "bottom", textDecoration = "bold", wrapText = TRUE)
# Write the data to the sheets
writeDataTable(excel_survey, sheet = "question_weights", x = question_weights, tableStyle = "TablestyleMedium6", headerStyle = bold_header)
writeDataTable(excel_survey, sheet = "clean_survey22", x = survey22, tableStyle = "TablestyleMedium7")
writeDataTable(excel_survey, sheet = "num_responses22_21", x = num_responses, tableStyle = "TablestyleMedium8")
writeDataTable(excel_survey, sheet = "satisfaction_table22", x = satisfaction_table22)
writeDataTable(excel_survey, sheet = "mean_satisfaction_by_facility22", x = mean_sat_table22)
# Export the file
saveWorkbook(excel_survey, "TSS_Survey_Analysis_Test.xlsx")
print(colnames(num_responses))
print(colnames(num_responses))
print(colnames(question_weights))
## LOAD QUESTION WEIGHT TABL ##
question_weights = read_excel("~/Desktop/question_weight.xlsx") %>%
rename(., "" = "...5")
## LOAD QUESTION WEIGHT TABL ##
question_weights = read_excel("~/Desktop/question_weight.xlsx") %>%
rename("" = "...5")
## LOAD QUESTION WEIGHT TABL ##
question_weights = read_excel("~/Desktop/question_weight.xlsx") %>%
rename(NULL = "...5")
# Add some sheets to the workbook
addWorksheet(excel_survey, "question_weights")
bold_header = createStyle(border = "bottom", textDecoration = "bold", wrapText = TRUE)
# Create a blank workbook
excel_survey = createWorkbook()
# Add some sheets to the workbook
addWorksheet(excel_survey, "question_weights")
addWorksheet(excel_survey, "clean_survey22")
addWorksheet(excel_survey, "num_responses22_21")
addWorksheet(excel_survey, "satisfaction_table22")
addWorksheet(excel_survey, "mean_satisfaction_by_facility22")
# Write the data to the sheets
writeDataTable(excel_survey, sheet = "question_weights", x = question_weights, tableStyle = "TablestyleMedium6", headerStyle = bold_header)
writeDataTable(excel_survey, sheet = "clean_survey22", x = survey22, tableStyle = "TablestyleMedium7")
writeDataTable(excel_survey, sheet = "num_responses22_21", x = num_responses, tableStyle = "TablestyleMedium8")
writeDataTable(excel_survey, sheet = "satisfaction_table22", x = satisfaction_table22)
writeDataTable(excel_survey, sheet = "mean_satisfaction_by_facility22", x = mean_sat_table22)
# Export the file
saveWorkbook(excel_survey, "TSS_Survey_Analysis_Test.xlsx")
## LOAD QUESTION WEIGHT TABL ##
question_weights = read_excel("~/Desktop/question_weight.xlsx") %>%
rename(NULL = "...5") %>%
rename(NULL = "...6")
## LOAD QUESTION WEIGHT TABL ##
question_weights = read_excel("~/Desktop/question_weight.xlsx") %>%
rename("5" = "...5") %>%
rename("6" = "...6")
print(colnames(question_weights))
source("~/Desktop/TSS_folder/tenant_survey_functionsCopy.R")
## Tables that have just the satisfaction data for the surveys and the mean
## satisfaction data by question
satisfaction_table22 = satisfaction_table(survey22)
View(satisfaction_table22)
## LOAD QUESTION WEIGHT TABL ##
question_weights = read_excel("~/Desktop/question_weight.xlsx") %>%
rename("5" = "...5") %>%
rename("6" = "...6")
## Responses by year
num_responses = resp_by_year(survey22)
## Tables that have just the satisfaction data for the surveys and the mean
## satisfaction data by question
satisfaction_table22 = satisfaction_table(survey22)
mean_sat_table22 = mean_question_satisfaction_by_facility(survey22)
bold_header = createStyle(border = "bottom", textDecoration = "bold", wrapText = TRUE)
# Create a blank workbook
excel_survey = createWorkbook()
# Add some sheets to the workbook
addWorksheet(excel_survey, "question_weights")
addWorksheet(excel_survey, "clean_survey22")
addWorksheet(excel_survey, "num_responses22_21")
addWorksheet(excel_survey, "satisfaction_table22")
addWorksheet(excel_survey, "mean_satisfaction_by_facility22")
# Set column widths
setColWidths(excel_survey, sheet = 1, cols = c(1:2, 7), widths = "auto")
setColWidths(excel_survey, sheet = 4, cols = 1, widths = 46.33)
setColWidths(excel_survey, sheet = c(3, 4, 5), cols = 1, widths = 46.33)
bold_header = createStyle(border = "bottom", textDecoration = "bold", wrapText = TRUE)
# Create a blank workbook
excel_survey = createWorkbook()
# Add some sheets to the workbook
addWorksheet(excel_survey, "question_weights")
addWorksheet(excel_survey, "clean_survey22")
addWorksheet(excel_survey, "num_responses22_21")
addWorksheet(excel_survey, "satisfaction_table22")
addWorksheet(excel_survey, "mean_satisfaction_by_facility22")
# Set column widths
setColWidths(excel_survey, sheet = 1, cols = c(1:2, 7), widths = "auto")
setColWidths(excel_survey, sheet = 4, cols = 1, widths = 46.33)
setColWidths(excel_survey, sheet = 3, cols = 1, widths = 46.33)
setColWidths(excel_survey, sheet = 4, cols = 1, widths = 46.33)
setColWidths(excel_survey, sheet = 5, cols = 1, widths = 46.33)
# Write the data to the sheets
writeDataTable(excel_survey, sheet = "question_weights", x = question_weights, tableStyle = "TablestyleMedium6", headerStyle = bold_header)
writeDataTable(excel_survey, sheet = "clean_survey22", x = survey22, tableStyle = "TablestyleMedium6")
writeDataTable(excel_survey, sheet = "num_responses22_21", x = num_responses, tableStyle = "TablestyleMedium6")
writeDataTable(excel_survey, sheet = "satisfaction_table22", x = satisfaction_table22, "TablestyleMedium6")
writeDataTable(excel_survey, sheet = "satisfaction_table22", x = satisfaction_table22, tableStyle = "TablestyleMedium6")
writeDataTable(excel_survey, sheet = "mean_satisfaction_by_facility22", x = mean_sat_table22, tableStyle = "TablestyleMedium6")
# Export the file
saveWorkbook(excel_survey, "TSS_Survey_Analysis_Test.xlsx")
source("~/Desktop/TSS_folder/tenant_survey_functionsCopy.R")
source("~/Desktop/TSS_folder/tenant_survey_functionsCopy.R")
## SURVEY LOADING SORTING AND CLEANING ##
## UPDATE THE FILE PATHS TO REFLECT THE NAMES OF THE SURVEYS ON YOUR MACHINE##
originalsurvey22 = read_excel("~/Desktop/cc_tenant_satisfaction_survey/materials/cc_2022_tenSatSurvey.xlsx")
survey22 = read_excel("~/Desktop/cc_tenant_satisfaction_survey/materials/cc_2022_tenSatSurvey.xlsx")
survey21 = read_excel("~/Desktop/cc_tenant_satisfaction_survey/materials/cc_2021_tenSatSurvey.xlsx")
survey22 = clean_survey(survey22) # clean 2022 survey
survey21 = clean_survey(survey21) # clean 2021 survey
## LOAD QUESTION WEIGHT TABL ##
question_weights = read_excel("~/Desktop/question_weight.xlsx") %>%
rename("5" = "...5") %>%
rename("6" = "...6")
print(colnames(question_weights))
## Responses by year
num_responses = resp_by_year(survey22)
## Tables that have just the satisfaction data for the surveys and the mean
## satisfaction data by question
satisfaction_table22 = satisfaction_table(survey22)
mean_sat_table22 = mean_question_satisfaction_by_facility(survey22)
bold_header = createStyle(border = "bottom", textDecoration = "bold", wrapText = TRUE)
# Create a blank workbook
excel_survey = createWorkbook()
# Add some sheets to the workbook
addWorksheet(excel_survey, "clean_survey22")
addWorksheet(excel_survey, "satisfaction_table22")
addWorksheet(excel_survey, "mean_satisfaction_by_facility22")
addWorksheet(excel_survey, "num_responses22_21")
addWorksheet(excel_survey, "question_weights")
# Set column widths
setColWidths(excel_survey, sheet = 1, cols = 1, widths = 46.33)
setColWidths(excel_survey, sheet = 2, cols = 1, widths = 46.33)
setColWidths(excel_survey, sheet = 3, cols = 1, widths = 46.33)
setColWidths(excel_survey, sheet = 4, cols = 1, widths = 46.33)
setColWidths(excel_survey, sheet = 4, cols = c(3, 4), widths = 18.17)
setColWidths(excel_survey, sheet = 5, cols = 1, widths = 19.33)
setColWidths(excel_survey, sheet = 5, cols = 2, widths = 46.33)
# Write the data to the sheets
writeDataTable(excel_survey, sheet = "question_weights", x = question_weights, tableStyle = "TablestyleMedium6", headerStyle = bold_header)
writeDataTable(excel_survey, sheet = "clean_survey22", x = survey22, tableStyle = "TablestyleMedium6")
writeDataTable(excel_survey, sheet = "num_responses22_21", x = num_responses, tableStyle = "TablestyleMedium6")
writeDataTable(excel_survey, sheet = "satisfaction_table22", x = satisfaction_table22, tableStyle = "TablestyleMedium6")
writeDataTable(excel_survey, sheet = "mean_satisfaction_by_facility22", x = mean_sat_table22, tableStyle = "TablestyleMedium6")
# Export the file
saveWorkbook(excel_survey, "TSS_Survey_Analysis_Test.xlsx")
bold_header = createStyle(border = "bottom", textDecoration = "bold", wrapText = TRUE)
# Create a blank workbook
excel_survey = createWorkbook()
# Add some sheets to the workbook
addWorksheet(excel_survey, "clean_survey22")
addWorksheet(excel_survey, "satisfaction_table22")
addWorksheet(excel_survey, "mean_satisfaction_by_facility22")
addWorksheet(excel_survey, "num_responses22_21")
addWorksheet(excel_survey, "question_weights")
# Set column widths
setColWidths(excel_survey, sheet = 1, cols = 1, widths = 46.33)
setColWidths(excel_survey, sheet = 2, cols = 1, widths = 46.33)
setColWidths(excel_survey, sheet = 3, cols = 1, widths = 46.33)
setColWidths(excel_survey, sheet = 4, cols = 1, widths = 46.33)
setColWidths(excel_survey, sheet = 4, cols = c(2, 3), widths = 18.17)
setColWidths(excel_survey, sheet = 5, cols = 1, widths = 19.33)
setColWidths(excel_survey, sheet = 5, cols = 2, widths = 46.33)
setColWidths(excel_survey, sheet = 5, cols = c(5, 6), widths = 5.00)
setColWidths(excel_survey, sheet = 5, cols = 7, widths = 28.00)
# Write the data to the sheets
writeDataTable(excel_survey, sheet = "question_weights", x = question_weights, tableStyle = "TablestyleMedium6", headerStyle = bold_header)
writeDataTable(excel_survey, sheet = "clean_survey22", x = survey22, tableStyle = "TablestyleMedium6")
writeDataTable(excel_survey, sheet = "num_responses22_21", x = num_responses, tableStyle = "TablestyleMedium6")
writeDataTable(excel_survey, sheet = "satisfaction_table22", x = satisfaction_table22, tableStyle = "TablestyleMedium6")
writeDataTable(excel_survey, sheet = "mean_satisfaction_by_facility22", x = mean_sat_table22, tableStyle = "TablestyleMedium6")
# Export the file
saveWorkbook(excel_survey, "TSS_Survey_Analysis_Test.xlsx")
bold_header = createStyle(border = "bottom", textDecoration = "bold", wrapText = TRUE)
# Create a blank workbook
excel_survey = createWorkbook()
# Add some sheets to the workbook
addWorksheet(excel_survey, "clean_survey22")
addWorksheet(excel_survey, "satisfaction_table22")
addWorksheet(excel_survey, "mean_satisfaction_by_facility22")
addWorksheet(excel_survey, "num_responses22_21")
addWorksheet(excel_survey, "question_weights")
# Set column widths
setColWidths(excel_survey, sheet = 1, cols = 1, widths = 46.33)
setColWidths(excel_survey, sheet = 2, cols = 1, widths = 46.33)
setColWidths(excel_survey, sheet = 3, cols = 1, widths = 46.33)
setColWidths(excel_survey, sheet = 4, cols = 1, widths = 46.33)
setColWidths(excel_survey, sheet = 4, cols = c(2, 3), widths = 18.17)
setColWidths(excel_survey, sheet = 5, cols = 1, widths = 19.33)
setColWidths(excel_survey, sheet = 5, cols = 2, widths = 46.33)
setColWidths(excel_survey, sheet = 5, cols = c(5, 6), widths = 5.00)
setColWidths(excel_survey, sheet = 5, cols = 7, widths = 28.00)
# Write the data to the sheets
writeDataTable(excel_survey, sheet = "question_weights", x = question_weights, tableStyle = "TablestyleMedium6", headerStyle = bold_header)
writeDataTable(excel_survey, sheet = "clean_survey22", x = survey22, tableStyle = "TablestyleMedium6")
writeDataTable(excel_survey, sheet = "num_responses22_21", x = num_responses, tableStyle = "TablestyleMedium6")
writeDataTable(excel_survey, sheet = "satisfaction_table22", x = satisfaction_table22, tableStyle = "TablestyleMedium6")
writeDataTable(excel_survey, sheet = "mean_satisfaction_by_facility22", x = mean_sat_table22, tableStyle = "TablestyleMedium6")
# Export the file
saveWorkbook(excel_survey, "TSS_Survey_Analysis_Test2.xlsx")
## MERGE THE RESPONSES BY FACILITY USING THE RESPONSES FROM MOST RECENT SURVEY ##
## NOTE: Might need to add survey input functionality (2021 or 2022 based on input)
resp_by_year = function(survey) {
resp_by_facility_22 = resp_by_facility(survey)
resp_by_facility_21 = resp_by_facility(survey21)
left_join(resp_by_facility_22, resp_by_facility_21,
by = "facility", suffix = c(".2022", ".2021 ")) %>%
rename("Num_Resps_2022" = "n.2022") %>%
rename("Num_Resps_2021" = "n.2021 ") %>%
arrange(., -Num_Resps_2022) %>%
transform(., Percentage_Change = ((Num_Resps_2022-Num_Resps_2021)/Num_Resps_2022)*100)
}
source("~/Desktop/TSS_folder/tenant_survey_functionsCopy.R")
## Responses by year
num_responses = resp_by_year(survey22)
View(num_responses)
source("~/Desktop/TSS_folder/tenant_survey_functionsCopy.R")
## Responses by year
num_responses = resp_by_year(survey22)
View(num_responses)
source("~/Desktop/TSS_folder/tenant_survey_functionsCopy.R")
## Responses by year
num_responses = resp_by_year(survey22)
source("~/Desktop/TSS_folder/tenant_survey_functionsCopy.R")
## Responses by year
num_responses = resp_by_year(survey22)
source("~/Desktop/TSS_folder/tenant_survey_functionsCopy.R")
source("~/Desktop/TSS_folder/tenant_survey_functionsCopy.R")
## Responses by year
num_responses = resp_by_year(survey22)
View(num_responses)
source("~/Desktop/TSS_folder/tenant_survey_functionsCopy.R")
## Responses by year
num_responses = resp_by_year(survey22)
View(num_responses)
source("~/Desktop/TSS_folder/tenant_survey_functionsCopy.R")
source("~/Desktop/TSS_folder/tenant_survey_functionsCopy.R")
## Responses by year
num_responses = resp_by_year(survey22)
View(num_responses)
mean_sat_table22 = mean_question_satisfaction_by_facility(survey22)
View(mean_sat_table22)
View(num_responses)
source("~/Desktop/TSS_folder/tenant_survey_functionsCopy.R")
## SURVEY LOADING SORTING AND CLEANING ##
## UPDATE THE FILE PATHS TO REFLECT THE NAMES OF THE SURVEYS ON YOUR MACHINE##
originalsurvey22 = read_excel("~/Desktop/cc_tenant_satisfaction_survey/materials/cc_2022_tenSatSurvey.xlsx")
survey22 = read_excel("~/Desktop/cc_tenant_satisfaction_survey/materials/cc_2022_tenSatSurvey.xlsx")
survey21 = read_excel("~/Desktop/cc_tenant_satisfaction_survey/materials/cc_2021_tenSatSurvey.xlsx")
survey22 = clean_survey(survey22) # clean 2022 survey
survey21 = clean_survey(survey21) # clean 2021 survey
## LOAD QUESTION WEIGHT TABL ##
question_weights = read_excel("~/Desktop/question_weight.xlsx") %>%
rename("5" = "...5") %>%
rename("6" = "...6")
## Responses by year
num_responses = resp_by_year(survey22)
## Tables that have just the satisfaction data for the surveys and the mean
## satisfaction data by question
satisfaction_table22 = satisfaction_table(survey22)
mean_sat_table22 = mean_question_satisfaction_by_facility(survey22)
#header with bolded and wrapped text if desired
#bold_header = createStyle(border = "bottom", textDecoration = "bold", wrapText = TRUE)
# Create a blank workbook
excel_survey = createWorkbook()
big_tables = createWorkbook()
# Add some sheets to the workbook
addWorksheet(big_tables, "clean_survey22")
addWorksheet(big_tables, "satisfaction_table22")
addWorksheet(excel_survey, "mean_satisfaction_by_facility22")
addWorksheet(excel_survey, "num_responses22_21")
addWorksheet(excel_survey, "question_weights")
# Set column widths
setColWidths(big_tables, sheet = 1, cols = 1, widths = 46.33)
setColWidths(big_tables, sheet = 2, cols = 1, widths = 46.33)
setColWidths(excel_survey, sheet = 1, cols = 1, widths = 46.33)
setColWidths(excel_survey, sheet = 2, cols = 1, widths = 46.33)
setColWidths(excel_survey, sheet = 2, cols = c(2, 3, 4), widths = 18.17)
setColWidths(excel_survey, sheet = 3, cols = 1, widths = 19.33)
setColWidths(excel_survey, sheet = 3, cols = 2, widths = 81.00)
setColWidths(excel_survey, sheet = 3, cols = c(5, 6), widths = 5.00)
setColWidths(excel_survey, sheet = 3, cols = 7, widths = 28.00)
# Write the data to the sheets
writeDataTable(big_tables, sheet = "clean_survey22", x = survey22,
tableStyle = "TablestyleMedium6")
writeDataTable(big_tables, sheet = "satisfaction_table22",
x = satisfaction_table22, tableStyle = "TablestyleMedium6")
writeDataTable(excel_survey, sheet = "mean_satisfaction_by_facility22",
x = mean_sat_table22, tableStyle = "TablestyleMedium6")
writeDataTable(excel_survey, sheet = "num_responses22_21", x = num_responses,
tableStyle = "TablestyleMedium6")
writeDataTable(excel_survey, sheet = "question_weights", x = question_weights,
tableStyle = "TablestyleMedium6", headerStyle = bold_header)
# Export the file
saveWorkbook(big_tables, "TSS_Survey_Analysis_BigTables.xlsx")
saveWorkbook(excel_survey, "TSS_Survey_Analysis_ExcelSurvey.xlsx")
source("~/Desktop/TSS_folder/tenant_survey_functionsCopy.R")
source("~/Desktop/TSS_folder/tenant_survey_functionsCopy.R")
source("~/Desktop/TSS_folder/tenant_survey_functionsCopy.R")
source("~/Desktop/TSS_folder/tenant_survey_functionsCopy.R")
source("~/Desktop/TSS_folder/tenant_survey_functionsCopy.R")
survey22 = read_excel("~/Desktop/cc_tenant_satisfaction_survey/materials/cc_2022_tenSatSurvey.xlsx")
survey22 = clean_survey(survey22) # clean 2022 survey
## Tables that have just the satisfaction data for the surveys and the mean
## satisfaction data by question
satisfaction_table22 = satisfaction_table(survey22)
View(satisfaction_table22)
source("~/Desktop/TSS_folder/tenant_survey_functionsCopy.R")
source("~/Desktop/TSS_folder/tenant_survey_functionsCopy.R")
resp_table = response_table(survey22)
transpo_table = transportation_table(survey22)
View(survey22)
source("~/Desktop/TSS_folder/tenant_survey_functionsCopy.R")
resp_table = response_table(survey22)
transpo_table = transportation_table(survey22)
View(resp_table)
## SURVEY LOADING SORTING AND CLEANING ##
## UPDATE THE FILE PATHS TO REFLECT THE NAMES OF THE SURVEYS ON YOUR MACHINE##
originalsurvey22 = read_excel("~/Desktop/cc_tenant_satisfaction_survey/materials/cc_2022_tenSatSurvey.xlsx")
View(originalsurvey22)
source("~/Desktop/TSS_folder/tenant_survey_functionsCopy.R")
source("~/Desktop/TSS_folder/tenant_survey_functionsCopy.R")
View(resp_table)
source("~/Desktop/TSS_folder/tenant_survey_functionsCopy.R")
source("~/Desktop/TSS_folder/tenant_survey_functionsCopy.R")
resp_table = response_table(survey22)
source("~/Desktop/TSS_folder/tenant_survey_functionsCopy.R")
resp_table = response_table(survey22)
source("~/Desktop/TSS_folder/tenant_survey_functionsCopy.R")
resp_table = response_table(survey22)
source("~/Desktop/TSS_folder/tenant_survey_functionsCopy.R")
resp_table = response_table(survey22)
source("~/Desktop/TSS_folder/tenant_survey_functionsCopy.R")
source("~/Desktop/TSS_folder/tenant_survey_functionsCopy.R")
resp_table = response_table(survey22)
resp_table = response_table(survey22)
source("~/Desktop/TSS_folder/tenant_survey_functionsCopy.R")
resp_table = response_table(survey22)
source("~/Desktop/TSS_folder/tenant_survey_functionsCopy.R")
resp_table = response_table(survey22)
View(resp_table)
source("~/Desktop/TSS_folder/tenant_survey_functionsCopy.R")
resp_table = response_table(survey22)
View(resp_table)
View(survey22)
source("~/Desktop/TSS_folder/tenant_survey_functionsCopy.R")
resp_table = response_table(survey22)
View(resp_table)
source("~/Desktop/TSS_folder/tenant_survey_functionsCopy.R")
source("~/Desktop/TSS_folder/tenant_survey_functionsCopy.R")
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(readxl)
library(gt)
library(knitr)
library(openxlsx)
library(janitor)
#library(matrixStats)
source("tenant_survey_functionsCopy.R")
## SURVEY LOADING SORTING AND CLEANING ##
## UPDATE THE FILE PATHS TO REFLECT THE NAMES OF THE SURVEYS ON YOUR MACHINE##
originalsurvey22 = read_excel("~/Desktop/cc_tenant_satisfaction_survey/materials/cc_2022_tenSatSurvey.xlsx")
survey22 = read_excel("~/Desktop/cc_tenant_satisfaction_survey/materials/cc_2022_tenSatSurvey.xlsx")
survey21 = read_excel("~/Desktop/cc_tenant_satisfaction_survey/materials/cc_2021_tenSatSurvey.xlsx")
survey22 = clean_survey(survey22) # clean 2022 survey
survey21 = clean_survey(survey21) # clean 2021 survey
## LOAD QUESTION WEIGHT TABL ##
question_weights = read_excel("~/Desktop/question_weight.xlsx") %>%
rename("5" = "...5") %>%
rename("6" = "...6")
## SURVEY LOADING SORTING AND CLEANING ##
## UPDATE THE FILE PATHS TO REFLECT THE NAMES OF THE SURVEYS ON YOUR MACHINE##
originalsurvey22 = read_excel("./past_surveys/TSS_2022Copy.xlsx")
View(originalsurvey22)
source("~/Desktop/TSS_folder/tenant_survey_functionsCopy.R")
source("~/Desktop/TSS_folder/r_code/TSS_R_functions.R", echo=TRUE)
setwd("~/Desktop/TSS_folder/r_code")
source("~/Desktop/TSS_folder/r_code/TSS_R_functions.R", echo=TRUE)
source("~/Desktop/TSS_folder/r_code/TSS_R_analysis.R", echo=TRUE)
View(clean_past_resps_list)
